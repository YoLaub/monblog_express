<!DOCTYPE html>
<html lang="fr">
<%- include('layouts/header') %>

<body>
<%- include('layouts/navbar') %>

<!-- Page Header -->
<header class="masthead" style="background-image: url('<%= encodeURI(blogpost.image) %>')">
<div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="post-heading">
                    <h1><%= blogpost.title %></h1>
                    <h2 class="subheading">
                        <%= blogpost.body.length > 200 ? blogpost.body.substring(0, 200) + '...' : blogpost.body %>
                    </h2>
                    <span class="meta">
                            Publié le
                            <%= new Date(blogpost.datePosted).toLocaleDateString('fr-FR', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric'
                            }) %>
                        </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article class="mb-4">
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="post-content">
                    <%- blogpost.body %>
                </div>

                <!-- Métadonnées -->
                <div class="mt-5 pt-4 border-top">
                    <div class="d-flex justify-content-between align-items-center">
                        <a href="/" class="btn btn-outline-primary">
                            <i class="fas fa-arrow-left"></i> Retour aux articles
                        </a>
                        <small class="text-muted">
                            <i class="far fa-calendar"></i>
                            <%= new Date(blogpost.createdAt || blogpost.datePosted).toLocaleString('fr-FR') %>
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <% if (loggedIn) { %>
        <div class="admin-actions mb-4">
            <a href="/posts/edit/<%= blogpost._id %>" class="btn btn-warning text-white">
                <i class="fas fa-edit"></i> Modifier
            </a>
            <form action="/posts/delete/<%= blogpost._id %>" method="POST" class="d-inline" onsubmit="return confirm('Supprimer définitivement cet article ?')">
                <button class="btn btn-danger">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            </form>
        </div>
    <% } %>
</article>

<%- include('layouts/footer') %>
<%- include('layouts/scripts') %>
</body>
</html>
